// ===========================================================================//	PPsetjmp68K.c					©1994 Metrowerks Inc. All rights reserved.// ===========================================================================////	This file contains the 68K source code for the standard C library//	routines setjmp and longjmp, as well as for a special version of longjmp//	that destroys C++ stack-based objects that go out of scope as a result//	of the jump.////	We provide this file as a convenience for 68K PowerPlant projects.//	Most PowerPlant programs don't use the ANSI C libraries, since they//	use Toolbox routines to perform "library" functions. However, PowerPlant//	uses setjmp & longjmp as the basis for its exception handling scheme.//	Rather than requiring you to add the entire ANSI C library just for//	these two functions, we have included the source to these routines//	as a separate file which you can add to your project.////	These routines are part of the 68K ANSI C libraries. You should not add//	this file to your project if you use the ANSI C library (any version).//	If you do, y ou will get a linker error for multiple definitions of//	the same functions.////	For the PowerPC, these routine are part of the MWCRuntime.lib, so you//	don't need to add this file to PowerPC projects. There is an//	"#ifndef powerc" test at the top of the file, so the file is ignored//	if you do inadvertantly add it to a PowerPC project.#ifndef powerc#include <stddef.h>#include <setjmp.h>#include <CPlusLib68K.h>asm int setjmp(jmp_buf env){	movea.l	(sp)+,a1	movea.l	(sp),a0	move.l	__local_destructor_chain,(a0)	movem.l	d3-d7/a1-a4/a6-a7,4(a0)	moveq	#0,d0	jmp		(a1)}asm void longjmp(jmp_buf env,int val){	addq.l	#4,sp	movea.l	(sp)+,a0#if __fourbyteints__	move.l	(sp),d0#else	move.w	(sp),d0#endif	bne.s	l0	moveq	#1,d0l0:	move.l	(a0),__local_destructor_chain	movem.l	4(a0),d3-d7/a1-a4/a6-a7	jmp		(a1)}void __longjmp_ldestr(jmp_buf env,int val){	__destroy_local_objects_to((DestructorChain *)*env);	longjmp(env,val);}#endif